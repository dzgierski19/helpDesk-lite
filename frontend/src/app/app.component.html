<div class="app-shell" [ngClass]="{ 'app-shell--login': isLoginRoute }">
  <header class="app-header" [ngClass]="{ 'app-header--login': isLoginRoute }">
    <div class="header-ambient">
      <span class="ambient-orb ambient-orb--one"></span>
      <span class="ambient-orb ambient-orb--two"></span>
      <span class="ambient-orb ambient-orb--three"></span>
    </div>

    <div class="brand-line">
      <div class="brand">
        <div class="brand-logo">
          <span>HL</span>
          <svg viewBox="0 0 120 120" aria-hidden="true">
            <defs>
              <linearGradient id="glow" x1="0" y1="0" x2="1" y2="1">
                <stop offset="0%" stop-color="#38bdf8" stop-opacity="0.9" />
                <stop offset="100%" stop-color="#a855f7" stop-opacity="0.9" />
              </linearGradient>
            </defs>
            <circle cx="60" cy="60" r="58" stroke="url(#glow)" stroke-width="4" fill="none" />
          </svg>
        </div>
        <div class="brand-copy">
          <p class="eyebrow">Helpdesk Lite</p>
          <h1>Customer ticketing workspace</h1>
          <p class="subtitle">Manage authentication issues, requests, and AI-powered triage suggestions in one place.</p>
        </div>
      </div>
    </div>

    <nav class="app-actions">
      <ng-container *ngIf="(isAuthenticated$ | async); else loggedOut">
        <div class="user-summary" *ngIf="currentUser$ | async as currentUser">
          <div class="user-name">{{ currentUser.name }}</div>
          <div class="user-role">{{ currentUser.role | titlecase }}</div>
        </div>
        <button class="new-ticket-button" type="button" (click)="openNewTicket()">
          Create Ticket
        </button>
        <button class="logout-button" type="button" (click)="onLogout()">
          Logout
        </button>
      </ng-container>
      <ng-template #loggedOut>
        <a class="login-link" routerLink="/login">
          <span class="login-icon" aria-hidden="true">üîê</span>
          Login
        </a>
      </ng-template>
    </nav>

    <div class="hero-metrics">
      <div class="header-pills">
        <span class="pill pill--online">
          <span class="dot"></span>
          Backend live
        </span>
        <span class="pill pill--storybook">
          <mat-icon fontIcon="auto_graph"></mat-icon>
          Storybook synced
        </span>
        <span class="pill pill--llm">LLM-assisted delivery</span>
      </div>
    </div>
  </header>

  <main class="app-content" [ngClass]="{ 'app-content--login': isLoginRoute }">
    <section class="summary-bar" *ngIf="(isAuthenticated$ | async) && !isLoginRoute">
      <div class="summary-item">
        <span class="summary-label">Live tickets</span>
        <strong>{{ liveTickets$ | async }}</strong>
      </div>
      <div class="summary-item">
        <span class="summary-label">Awaiting triage</span>
        <strong>{{ awaitingTriage$ | async }}</strong>
      </div>
      <div class="summary-item">
        <span class="summary-label">Avg response</span>
        <strong>{{ avgResponseTime$ | async }}</strong>
      </div>
    </section>
    <app-loader></app-loader>
    <router-outlet></router-outlet>
  </main>
</div>
